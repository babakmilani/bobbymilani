<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CZDJHG7RBN"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CZDJHG7RBN');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <title>Creator Community Hub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            /* We need more content for scrolling, so min-height is critical for testing! */
            min-height: 200vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 3em;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .tagline {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 20px;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .benefits {
            list-style: none;
            margin: 20px 0;
        }

        .benefits li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .benefits li:before {
            content: "‚ú®";
            position: absolute;
            left: 0;
        }

        .signup-form {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.9);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .checkbox-group {
            text-align: left;
            margin: 20px 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
        }

        .submit-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            background: white;
            color: #667eea;
            transform: translateY(-2px);
        }

        .legal-text {
            font-size: 0.8em;
            opacity: 0.8;
            margin-top: 20px;
            line-height: 1.4;
        }

        .success-message {
            display: none;
            background: #4CAF50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
        }

        /* ------------------------------------------- */
        /* --- POPUP STYLES --- */
        /* ------------------------------------------- */
        .page-popup {
            position: fixed;
            top: 20%;
            width: 300px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            z-index: 1000;
            transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-weight: bold;
            text-align: center;
        }

        /* Right-Side Competition Popup */
        #competition-popup {
            right: 0;
            transform: translateX(100%);
            background: #f8c050;
            color: #333;
            border-radius: 10px 0 0 10px;
            border: 2px solid #e0a800;
        }

        #competition-popup.show {
            transform: translateX(0);
        }

        /* Left-Side Membership Popup */
        #membership-popup {
            left: 0;
            transform: translateX(-100%);
            /* Start off-screen to the left */
            background: #d9534f;
            /* A warning/restrictive color (red) */
            color: white;
            border-radius: 0 10px 10px 0;
            /* Rounded only on the right side */
            border: 2px solid #c9302c;
        }

        #membership-popup.show {
            transform: translateX(0);
        }

        /* ------------------------------------------- */


        @media (max-width: 768px) {
            .hero-stats {
                gap: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 10px;
            }

            /* Adjust popups for smaller screens (they will both move to the bottom-center) */
            .page-popup {
                width: 90%;
                left: 5% !important;
                right: 5% !important;
                top: auto !important;
                bottom: 20px;
                border-radius: 10px;
                /* Reset transforms so 'show' can bring it into view */
                transform: translateX(0) !important;
            }

            #competition-popup {
                /* Hide competition popup a bit lower on mobile if both are visible */
                transform: translateY(150%) !important;
            }

            #membership-popup {
                /* Hide membership popup a bit higher on mobile if both are visible */
                transform: translateY(150%) !important;
            }

            #competition-popup.show,
            #membership-popup.show {
                /* On mobile, slide UP instead of side-to-side */
                transform: translateY(0) !important;
            }
        }
    </style>
</head>

<body>

    <div id="membership-popup" class="page-popup">
        ‚ö†Ô∏è **IMPORTANT:** Only channel members can join the community.
    </div>

    <div id="competition-popup" class="page-popup">
        üî• **First Competition:** Blue iMac M3...
    </div>

    <div class="container">
        <header>
            <div class="logo">Creator Hub</div>
            <div class="tagline">Join Our Exclusive Creator Community</div>
            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-number">20K+</div>
                    <div class="stat-label">YouTube Family</div>
                </div>
                <div class="stat">
                    <div class="stat-number">5K</div>
                    <div class="stat-label">Target Community</div>
                </div>
                <div class="stat">
                    <div class="stat-number">12</div>
                    <div class="stat-label">Monthly Prizes</div>
                </div>
            </div>
        </header>

        <div class="content-grid">
            <div class="card">
                <h2>üéØ Exclusive Community Access</h2>
                <p>Join a select group of our most engaged viewers for behind-the-scenes content, early video previews,
                    and direct interaction with our creator.</p>
                <ul class="benefits">
                    <li>Early access to new videos</li>
                    <li>Behind-the-scenes content</li>
                    <li>Monthly live Q&A sessions</li>
                    <li>Community Discord server</li>
                </ul>
            </div>

            <div class="card">
                <h2>üéÅ Monthly Prize Drawings</h2>
                <p>Every month, we host exclusive raffles with amazing prizes. From tech gadgets to unique experiences -
                    there's always something exciting to win!</p>
                <ul class="benefits">
                    <li>High-value monthly prizes</li>
                    <li>Exclusive raffle entries</li>
                    <li>Winner spotlights</li>
                    <li>Special bonus drawings</li>
                </ul>
            </div>

            <div class="card">
                <h2>üí¨ Direct Creator Connection</h2>
                <p>Get closer to the creative process with exclusive updates, polls on upcoming content, and the ability
                    to influence what we create next.</p>
                <ul class="benefits">
                    <li>Content polls and voting</li>
                    <li>Creator newsletters</li>
                    <li>Feedback opportunities</li>
                    <li>Community challenges</li>
                </ul>
            </div>
        </div>

        <div class="card signup-form">
            <h2>üöÄ Join Our Community</h2>
            <p>Ready to become part of something special? Join our exclusive community today!</p>

            <form id="communityForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name *</label>
                        <input type="text" id="firstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name *</label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number (Optional)</label>
                    <input type="tel" id="phone" name="phone" placeholder="(xxx) xxx - xxxx"
                        pattern="^(\(\d{3}\)\s*|\d{3}[-\s]*)\d{3}[-\s]*\d{4}$"
                        title="Phone number must be in the format (xxx) xxx-xxxx or 10 digits.">
                </div>

                <div class="form-group">
                    <label for="youtube">Your YouTube Handle/Name *</label>
                    <input type="text" id="youtube" name="youtube" required placeholder="@username or display name"
                        pattern="^@.*|.+@.+"
                        title="If using your handle, it should start with '@'. Otherwise, use your display name.">
                </div>

                <div class="form-group">
                    <label for="contact">Preferred Contact Method *</label>
                    <select id="contact" name="contact" required>
                        <option value="" disabled selected>Please choose a preference</option>
                        <option value="email">Email Only</option>
                        <option value="sms">SMS Only</option>
                        <option value="both">Both Email & SMS</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="terms" required>
                        I agree to the Terms & Conditions and Privacy Policy *
                    </label>
                </div>

                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="marketing">
                        I want to receive marketing communications and special offers
                    </label>
                </div>

                <button type="submit" class="submit-btn">Join the Community</button>
            </form>

            <div class="success-message" id="successMessage">
                <h3>üéâ Welcome to the Community!</h3>
                <p>Thank you for joining! You'll receive a welcome email within 24 hours with all the details about your
                    membership and upcoming raffles.</p>
            </div>

            <div class="legal-text">
                By joining, you agree to receive periodic emails about community updates, exclusive content, and monthly
                raffle announcements. You can unsubscribe at any time. This community operates independently from
                YouTube. Winners will be selected randomly and contacted via provided contact information. Prizes may
                vary by month and location restrictions may apply.
            </div>
        </div>
    </div>

    <script>
        // *** IMPORTANT: REPLACE THIS PLACEHOLDER WITH YOUR DEPLOYED GOOGLE APPS SCRIPT WEB APP URL ***
        const GOOGLE_APP_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxoFWO3moC_Zxg0snYEL6iNfWI_S-nm-Q2T9uhbFumKW4goVzouigdzt32nhLb9IgA7Hw/exec';
        // Example: https://script.google.com/macros/s/AKfyc.../exec'; 

        // --- NEW: Custom Validation Function ---
        function validateForm(data) {
            // Clean phone number: remove spaces, dashes, parentheses
            const phone = data.phone ? data.phone.replace(/[\s\-\(\)]/g, '') : '';
            const contactPreference = data.contact;

            // 1. Basic Required Fields Check
            // HTML 'required' handles most of this, but this is a good final check
            if (!data.firstName || !data.lastName || !data.email || !data.youtube || !contactPreference) {
                alert('‚ùå ERROR: Please fill in all required fields marked with an asterisk (*).');
                return false;
            }

            // 2. Contact Preference Logic
            // If SMS or Both is selected, the phone number must be present
            if ((contactPreference === 'sms' || contactPreference === 'both') && phone.length === 0) {
                alert('‚ùå ERROR: You selected SMS/Both for contact, but the Phone Number field is empty. Please enter your phone number.');
                return false;
            }

            // 3. Phone Format and Length Check (only if filled out)
            if (phone.length > 0) {
                // Check if it's exactly 10 digits
                if (!/^\d{10}$/.test(phone)) {
                    alert('‚ùå ERROR: Phone number must contain exactly 10 digits (e.g., (555) 555-1234).');
                    return false;
                }
            }

            // 4. Terms Check
            if (!data.terms) {
                alert('‚ùå ERROR: Please agree to the Terms & Conditions to continue.');
                return false;
            }

            // 5. Basic XSS Mitigation (Client-side scrub before sending)
            // Note: This must be REPLICATED and strengthened on the server-side for real security!
            for (const key in data) {
                if (typeof data[key] === 'string') {
                    // Replace < and > with HTML entities to neutralize potential script injection
                    data[key] = data[key].replace(/</g, "&lt;").replace(/>/g, "&gt;");
                }
            }

            return true; // All checks passed
        }
        // --- END NEW VALIDATION FUNCTION ---


        async function handleSubmit(event) {
            event.preventDefault(); // Stop the default form submission

            const form = event.target;
            const submitButton = form.querySelector('.submit-btn');

            // Get form data as a standard object
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            // --- Run custom validation first ---
            if (!validateForm(data)) {
                return; // Stop submission if validation fails
            }
            // -----------------------------------

            // Optional: Disable button and show loading state
            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';

            try {
                // Send data to Google Apps Script Web App
                const response = await fetch(GOOGLE_APP_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // Essential for Google Apps Script to prevent CORS issues
                    cache: 'no-cache',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    // Convert the data object into a URL-encoded string for the Apps Script to read easily
                    body: new URLSearchParams(data).toString(),
                });

                // Since we use 'no-cors', we can't check the response directly, 
                // but if the fetch completes without an error, we assume success.

                console.log('Form submission assumed successful.');

                // --- On Success ---
                document.getElementById('communityForm').style.display = 'none';
                document.getElementById('successMessage').style.display = 'block';

            } catch (error) {
                console.error('Submission Error:', error);
                alert('An error occurred during submission. Please try again.');

                // Re-enable button on failure
                submitButton.disabled = false;
                submitButton.textContent = 'Join the Community';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('communityForm');
            if (form) {
                form.addEventListener('submit', handleSubmit);
            }

            // --- Original Stat Animation Code (Kept for completeness) ---
            const stats = document.querySelectorAll('.stat-number');
            stats.forEach(stat => {
                const finalValue = stat.textContent;
                const numericValue = parseInt(finalValue.replace(/\D/g, ''));
                let currentValue = 0;
                const increment = numericValue / 50;

                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= numericValue) {
                        stat.textContent = finalValue;
                        clearInterval(timer);
                    } else {
                        const suffix = finalValue.includes('K') ? 'K+' : '';
                        stat.textContent = Math.floor(currentValue / 1000) + suffix;
                    }
                }, 30);
            });
            // -----------------------------------------------------------

            // -----------------------------------------------------------
            // --- UPDATED POPUP LOGIC TO HANDLE BOTH ---
            // -----------------------------------------------------------

            const competitionPopup = document.getElementById('competition-popup');
            const membershipPopup = document.getElementById('membership-popup');

            // Flags to ensure each popup only shows once per page load
            let hasShownCompetition = false;
            let hasShownMembership = false;

            const scrollThreshold = 300; // The scroll amount to trigger the popups
            const displayDuration = 5000; // 5 seconds in milliseconds

            function showAndHidePopup(popupElement) {
                // 1. Show the popup (slides in)
                popupElement.classList.add('show');

                // 2. Set a timer to hide the popup after 5 seconds
                setTimeout(() => {
                    // Hide the popup (slides back out)
                    popupElement.classList.remove('show');
                }, displayDuration);
            }

            // To ensure the two popups don't appear at exactly the same time, 
            // we'll offset the second one slightly.
            const offsetDelay = 1000; // 1 second offset

            function handleScroll() {
                if (window.scrollY > scrollThreshold) {

                    // Show Competition Popup (Right)
                    if (!hasShownCompetition) {
                        hasShownCompetition = true;
                        showAndHidePopup(competitionPopup);
                    }

                    // Show Membership Popup (Left), delayed by 1 second
                    if (!hasShownMembership) {
                        hasShownMembership = true;
                        setTimeout(() => {
                            showAndHidePopup(membershipPopup);
                            // After both have run, remove the scroll listener
                            window.removeEventListener('scroll', handleScroll);
                        }, offsetDelay);
                    }
                }
            }

            // Listen for the scroll event
            window.addEventListener('scroll', handleScroll);
            // -----------------------------------------------------------
        });
    </script>
</body>

</html>